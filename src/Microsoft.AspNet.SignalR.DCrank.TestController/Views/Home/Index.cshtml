@{
    ViewBag.Title = "Dashboard";
}

<html ng-app="angularModule" ng-controller="SignalRAngularCtrl">
<head>
    <title></title>
    <script src="~/Angular/angular.min.js"></script>
    <script src="~/Angular/AngularController.js"></script>
</head>
<body>
    <h1>Hud</h1>
    <h3>Remote Control</h3>
    <div class="jumbotron" style="max-height:400px; overflow:auto; min-width:800px;">
        <table class="table" id="uiView" style="border:solid; width:100%; font-size:1em">
            <tr style="border:solid;">
                <th style="border:solid; width:20%">Agent Id</th>
                <th style="border:solid; width:20%">Number of Workers</th>
                <th style="border:solid; width:20%">Start Workers</th>
                <th style="border:solid; width:40%">Current Workers</th>
            </tr>
            <tr style="border:solid;" data-ng-repeat="agent in agents">
                <td style="border:solid;">
                    <div style="width:100px; display:inline-block; margin-right:10px;">{{agent.number}} </div>
                    <button class="button" style="display:inline-block;" data-ng-click="showAgentLogging()">Logging</button>
                    <button class="button" style="display:inline-block;" data-ng-click="pingAgent(agent.id)">Ping</button>
                </td>
                <td style="border:solid;">{{agent.numberOfWorkers}}</td>
                <td style="border:solid;">
                    <div ng-controller="SignalRAngularCtrl">
                        Workers to Start: <input type="text" maxlength="5" size="5" data-ng-model="workersToStart">
                        <input class="button" type="submit" value="Start Workers" data-ng-click="startWorkers()">
                    </div>
                </td>
                <td style="border:solid;">
                    <div data-ng-repeat="worker in agent.workers">
                        <div style="width:100px; display:inline-block; margin-right:10px;">{{worker.id}}</div>
                        <button class="button" style="width:100px; display:inline-block;" data-ng-click="pingWorker(agent.id)">Ping</button>
                        <button class="button" style="width:100px; display:inline-block;" data-ng-click="showWorkerLogging()">Logging</button>
                        <button class="button" style="width:100px; display:inline-block;" data-ng-click="killWorker(agent.id)">Kill</button>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <div data-ng-repeat="agent in agents" data-ng-show="agent.display" style="border:solid">
        <ul data-ng-repeat="agentLogging in agent.output track by $index">{{agentLogging}}</ul>
    </div>

    <div data-ng-repeat="agent in agents" style="border:solid">
        <div data-ng-repeat="worker in agent.workers" data-ng-show="worker.display" style="border: dashed">
            <ul data-ng-repeat="workerLogging in worker.output track by $index">{{workerLogging}}</ul>
        </div>
    </div>

    <h3>Output Area</h3>

    <div class="jumbotron" style="max-height:400px; overflow:auto; min-width: 800px;">
        <ul data-ng-repeat="messages in uiGeneralDisplay track by $index">{{messages}}</ul>
    </div>

    @section scripts
    {
        <!--Reference the SignalR library. -->
        <script src="~/Scripts/jquery.signalR-2.1.0.min.js"></script>
        <!--Reference the autogenerated SignalR hub script. -->
        <script src="~/signalr/hubs"></script>

        <script>
            var controller = $.connection.controllerHub;

            // Established a group for the UI so that it can be identified by the hub
            $.connection.hub.qs = { UI: 1 };
            $.connection.hub.start().done(function () {
            });
        </script>
    }
</body>
</html>